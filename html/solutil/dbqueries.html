<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>solutil.dbqueries API documentation</title>
<meta name="description" content="Created on Tue Apr 16 09:49:48 2024 â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>solutil.dbqueries</code></h1>
</header>
<section id="section-intro">
<p>Created on Tue Apr 16 09:49:48 2024</p>
<p>@author: LES</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;
Created on Tue Apr 16 09:49:48 2024

@author: LES
&#34;&#34;&#34;
from datetime import datetime, timedelta, date, timezone
from pytz import timezone
import pandas as pd
import os
from dotenv import load_dotenv
import oracledb
import warnings


# Env Variable Retrieval
def get_env_variables(mandant:str, scope:str=&#39;get_ts&#39;):
    &#34;&#34;&#34;
    Retrieve setup variables from .env environment file, e.g., BelVis username &amp; password.

    Parameters:
        - **mandant** (str): Any existing Belvis Mandant. Commonly used: &#39;EPAG_PFM&#39; or &#39;EPAG_ENERGIE&#39;.
        - **scope** (str): Scope of to-be-retrieved variables. Can be &#39;all&#39; or &#39;get_ts&#39;.

    Returns:
        - **env_dict** (dict): Dictionary with environment variables of the selected scope.

    Notes:
        With &#39;get_ts&#39;, the resulting env_dict can directly be passed to the get_timeseries
        function and unpacked with the ** operator.
    &#34;&#34;&#34;
    # Try to load environment file if it exists
    if not load_dotenv():
        raise FileNotFoundError(&#34;No .env file exists in the current directory.&#34;)

    match scope:
        case &#39;all&#39;:
            env_dict = {key:value for (key, value) in os.environ}
        case &#39;get_ts&#39;:
            # Get input variables for get_timeseries functions
            env_keys = [&#39;mandant_user&#39;, &#39;mandant_pwd&#39;, &#39;mandant_addr&#39;]
            mandant_user = os.getenv(f&#39;{mandant}_USER&#39;)
            mandant_pwd = os.getenv(f&#39;{mandant}_PWD&#39;)
            mandant_addr = os.getenv(&#39;BELVIS_ADDR_NEW&#39;)
            env_values = [mandant_user, mandant_pwd, mandant_addr]

            # Combine to dict
            env_dict = dict(zip(env_keys, env_values))
        case _:
            env_dict = None
            print(f&#39;Scope input {scope} does not match options: [all, get_ts]&#39;)

    return env_dict


## 15min Time Series Retrieval
def get_timeseries_15min(ts_id: int, date_from, date_to,
                         mandant_user:str, mandant_pwd, mandant_addr:str,
                         offset_summertime: bool = False, col_name: str = &#39;value&#39;,
                         USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 15-minute resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                          Start date is inclusive of `date_from` value, i.e., the start date will
                          be included in the extraction range. Format examples:
                          - datetime(2024, 1, 1, 0, 0, 0)
                          - datetime.strptime(date_string, format)
                          - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **offset_summertime** (bool): Indicator whether summertime is offset, i.e., whether
                                        timestamps are in Etc/GMT-1 or local time. If False, code will
                                        directly localize timestamp at Etc/GMT-1, else it will
                                        first convert to CET before Etc/GMT-1.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **USE_OLD_CX_ORACLE** (bool): Switch variable to use old database connection module. Deprecated under
                                        Python versions &gt;3.6.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
&#34;&#34;&#34;
    if date_from.tzinfo is None:
        # Convert start and end dates if summertime offset is desired
        if offset_summertime:
            date_from = timezone(&#39;CET&#39;).localize(date_from)
            date_to = timezone(&#39;CET&#39;).localize(date_to)
            date_from = date_from.astimezone(timezone(&#39;Etc/GMT-1&#39;))
            date_to = date_to.astimezone(timezone(&#39;Etc/GMT-1&#39;)) # Etc/GMT-1 actually refers to GMT+1, as highlighted
            # in https://stackoverflow.com/questions/53076575/time-zones-etc-gmt-why-it-is-other-way-round
        else:
            # Localize timestamps to constant Etc/GMT-1
            date_from = timezone(&#39;Etc/GMT-1&#39;).localize(date_from)
            date_to = timezone(&#39;Etc/GMT-1&#39;).localize(date_to)

    # Convert back to str format for SQL Query
    str_from = date_from.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_wnmin195 tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            tsd.tstamp_ts &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define query string
    str_sql = f&#34;&#34;&#34;select zeitstempel, value from
                    (select
                        case when zeitstempel is not null
                                and zeitstempel &gt;= next_day( to_date(concat( extract(year from zeitstempel),
                                                                                &#39;0401.02&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                and zeitstempel &lt; next_day( to_date(concat( extract(year from zeitstempel),
                                                                                &#39;1101.03&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                then
                            zeitstempel + 0/24
                        else zeitstempel  end as zeitstempel, value, timeseries_l
                        from
                    (
                    select timeseries_l, tstamp_ts + 1/96 - 2/96 as zeitstempel, value1 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 2/96 - 2/96 as zeitstempel, value2 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 3/96 - 2/96 as zeitstempel, value3 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 4/96 - 2/96 as zeitstempel, value4 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 5/96 - 2/96 as zeitstempel, value5 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 6/96 - 2/96 as zeitstempel, value6 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 7/96 - 2/96 as zeitstempel, value7 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 8/96 - 2/96 as zeitstempel, value8 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 9/96 - 2/96 as zeitstempel, value9 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 10/96 - 2/96 as zeitstempel, value10 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 11/96 - 2/96 as zeitstempel, value11 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 12/96 - 2/96 as zeitstempel, value12 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 13/96 - 2/96 as zeitstempel, value13 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 14/96 - 2/96 as zeitstempel, value14 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 15/96 - 2/96 as zeitstempel, value15 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 16/96 - 2/96 as zeitstempel, value16 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 17/96 - 2/96 as zeitstempel, value17 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 18/96 - 2/96 as zeitstempel, value18 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 19/96 - 2/96 as zeitstempel, value19 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 20/96 - 2/96 as zeitstempel, value20 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 21/96 - 2/96 as zeitstempel, value21 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 22/96 - 2/96 as zeitstempel, value22 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 23/96 - 2/96 as zeitstempel, value23 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 24/96 - 2/96 as zeitstempel, value24 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 25/96 - 2/96 as zeitstempel, value25 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 26/96 - 2/96 as zeitstempel, value26 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 27/96 - 2/96 as zeitstempel, value27 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 28/96 - 2/96 as zeitstempel, value28 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 29/96 - 2/96 as zeitstempel, value29 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 30/96 - 2/96 as zeitstempel, value30 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 31/96 - 2/96 as zeitstempel, value31 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 32/96 - 2/96 as zeitstempel, value32 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 33/96 - 2/96 as zeitstempel, value33 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 34/96 - 2/96 as zeitstempel, value34 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 35/96 - 2/96 as zeitstempel, value35 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 36/96 - 2/96 as zeitstempel, value36 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 37/96 - 2/96 as zeitstempel, value37 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 38/96 - 2/96 as zeitstempel, value38 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 39/96 - 2/96 as zeitstempel, value39 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 40/96 - 2/96 as zeitstempel, value40 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 41/96 - 2/96 as zeitstempel, value41 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 42/96 - 2/96 as zeitstempel, value42 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 43/96 - 2/96 as zeitstempel, value43 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 44/96 - 2/96 as zeitstempel, value44 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 45/96 - 2/96 as zeitstempel, value45 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 46/96 - 2/96 as zeitstempel, value46 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 47/96 - 2/96 as zeitstempel, value47 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 48/96 - 2/96 as zeitstempel, value48 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 49/96 - 2/96 as zeitstempel, value49 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 50/96 - 2/96 as zeitstempel, value50 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 51/96 - 2/96 as zeitstempel, value51 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 52/96 - 2/96 as zeitstempel, value52 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 53/96 - 2/96 as zeitstempel, value53 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 54/96 - 2/96 as zeitstempel, value54 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 55/96 - 2/96 as zeitstempel, value55 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 56/96 - 2/96 as zeitstempel, value56 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 57/96 - 2/96 as zeitstempel, value57 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 58/96 - 2/96 as zeitstempel, value58 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 59/96 - 2/96 as zeitstempel, value59 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 60/96 - 2/96 as zeitstempel, value60 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 61/96 - 2/96 as zeitstempel, value61 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 62/96 - 2/96 as zeitstempel, value62 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 63/96 - 2/96 as zeitstempel, value63 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 64/96 - 2/96 as zeitstempel, value64 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 65/96 - 2/96 as zeitstempel, value65 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 66/96 - 2/96 as zeitstempel, value66 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 67/96 - 2/96 as zeitstempel, value67 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 68/96 - 2/96 as zeitstempel, value68 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 69/96 - 2/96 as zeitstempel, value69 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 70/96 - 2/96 as zeitstempel, value70 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 71/96 - 2/96 as zeitstempel, value71 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 72/96 - 2/96 as zeitstempel, value72 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 73/96 - 2/96 as zeitstempel, value73 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 74/96 - 2/96 as zeitstempel, value74 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 75/96 - 2/96 as zeitstempel, value75 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 76/96 - 2/96 as zeitstempel, value76 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 77/96 - 2/96 as zeitstempel, value77 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 78/96 - 2/96 as zeitstempel, value78 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 79/96 - 2/96 as zeitstempel, value79 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 80/96 - 2/96 as zeitstempel, value80 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 81/96 - 2/96 as zeitstempel, value81 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 82/96 - 2/96 as zeitstempel, value82 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 83/96 - 2/96 as zeitstempel, value83 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 84/96 - 2/96 as zeitstempel, value84 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 85/96 - 2/96 as zeitstempel, value85 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 86/96 - 2/96 as zeitstempel, value86 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 87/96 - 2/96 as zeitstempel, value87 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 88/96 - 2/96 as zeitstempel, value88 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 89/96 - 2/96 as zeitstempel, value89 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 90/96 - 2/96 as zeitstempel, value90 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 91/96 - 2/96 as zeitstempel, value91 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 92/96 - 2/96 as zeitstempel, value92 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 93/96 - 2/96 as zeitstempel, value93 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 94/96 - 2/96 as zeitstempel, value94 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 95/96 - 2/96 as zeitstempel, value95 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 96/96 - 2/96 as zeitstempel, value96 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) ))
                where zeitstempel &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                        zeitstempel &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;)&#34;&#34;&#34;
    # logging.info(&#34;before db data fetching&#34;)

    # DB Connection and Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 1:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 15min resolution.&#34;))

            # Fetch data from db
            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame([row[1] for row in ts_cursor], index=[row[0] for row in ts_cursor], columns=[&#39;value&#39;])
    if len(data_db) &gt; 0:
        data_db.index = data_db.index.tz_localize(&#39;Etc/GMT-1&#39;)

    # Reindexing &amp; Assignment of Return Variable
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(minutes=15), freq=&#39;15min&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;
    if len(data_db) &gt; 0:
        data_out[&#39;value&#39;] = data_db[&#39;value&#39;]
    if offset_summertime:
        data_out.index = data_out.index.tz_convert(&#39;CET&#39;)
    data_out[&#39;value&#39;] = pd.to_numeric(data_out[&#39;value&#39;])

    # Convert to pd.Series if only one column
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[&#39;value&#39;]

    return data_out


## 1h Time Series Retrieval
def get_timeseries_1h(ts_id: int, date_from, date_to,
                         mandant_user:str, mandant_pwd, mandant_addr:str,
                         offset_summertime: bool = False, col_name: str = &#39;value&#39;,
                         USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 1-hour resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                              Start date is inclusive of `date_from` value, i.e., the start date will
                              be included in the extraction range. Format examples:
                              - datetime(2024, 1, 1, 0, 0, 0)
                              - datetime.strptime(date_string, format)
                              - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **offset_summertime** (bool): Indicator whether summertime is offset, i.e., whether
                                        timestamps are in CET or local time. If False, code will
                                        directly localize timestamp at Etc/GMT-1, else it will
                                        first convert to CET before Etc/GMT-1.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **USE_OLD_CX_ORACLE** (bool): Switch variable to use old database connection module. Deprecated under
                                        Python versions &gt;3.6.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
    &#34;&#34;&#34;

    if date_from.tzinfo is None:
        if offset_summertime:
            date_from = timezone(&#39;CET&#39;).localize(date_from)
            date_to = timezone(&#39;CET&#39;).localize(date_to)
            date_from = date_from.astimezone(timezone(&#39;Etc/GMT-1&#39;))
            date_to = date_to.astimezone(timezone(&#39;Etc/GMT-1&#39;))
        else:
            date_from = timezone(&#39;Etc/GMT-1&#39;).localize(date_from)
            date_to = timezone(&#39;Etc/GMT-1&#39;).localize(date_to)

    # Convert back to str format for SQL Query
    str_from = date_from.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_wnmin195 tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            tsd.tstamp_ts &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define query string
    str_sql = f&#34;&#34;&#34;select zeitstempel, value from 
                    (select
                        case when zeitstempel is not null 
                                and zeitstempel &gt;= next_day( to_date(concat( extract(year from zeitstempel), 
                                                                                &#39;0401.02&#39;), &#39;yyyymmdd.HH&#39;) -8,7)  
                                and zeitstempel &lt; next_day( to_date(concat( extract(year from zeitstempel), 
                                                                                &#39;1101.03&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                then 
                            zeitstempel + 0/24
                        else zeitstempel  end as zeitstempel, value, timeseries_l
                        from
                    (
                    select timeseries_l, tstamp_ts + 1/24 - 2/24 as zeitstempel, value1 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 2/24 - 2/24 as zeitstempel, value2 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 3/24 - 2/24 as zeitstempel, value3 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 4/24 - 2/24 as zeitstempel, value4 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 5/24 - 2/24 as zeitstempel, value5 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 6/24 - 2/24 as zeitstempel, value6 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 7/24 - 2/24 as zeitstempel, value7 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 8/24 - 2/24 as zeitstempel, value8 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 9/24 - 2/24 as zeitstempel, value9 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 10/24 - 2/24 as zeitstempel, value10 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 11/24 - 2/24 as zeitstempel, value11 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 12/24 - 2/24 as zeitstempel, value12 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 13/24 - 2/24 as zeitstempel, value13 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 14/24 - 2/24 as zeitstempel, value14 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 15/24 - 2/24 as zeitstempel, value15 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 16/24 - 2/24 as zeitstempel, value16 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 17/24 - 2/24 as zeitstempel, value17 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 18/24 - 2/24 as zeitstempel, value18 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 19/24 - 2/24 as zeitstempel, value19 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 20/24 - 2/24 as zeitstempel, value20 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 21/24 - 2/24 as zeitstempel, value21 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 22/24 - 2/24 as zeitstempel, value22 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 23/24 - 2/24 as zeitstempel, value23 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 24/24 - 2/24 as zeitstempel, value24 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 25/24 - 2/24 as zeitstempel, value25 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 26/24 - 2/24 as zeitstempel, value26 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 27/24 - 2/24 as zeitstempel, value27 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 28/24 - 2/24 as zeitstempel, value28 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 29/24 - 2/24 as zeitstempel, value29 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 30/24 - 2/24 as zeitstempel, value30 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 31/24 - 2/24 as zeitstempel, value31 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 32/24 - 2/24 as zeitstempel, value32 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 33/24 - 2/24 as zeitstempel, value33 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 34/24 - 2/24 as zeitstempel, value34 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 35/24 - 2/24 as zeitstempel, value35 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 36/24 - 2/24 as zeitstempel, value36 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 37/24 - 2/24 as zeitstempel, value37 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 38/24 - 2/24 as zeitstempel, value38 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 39/24 - 2/24 as zeitstempel, value39 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 40/24 - 2/24 as zeitstempel, value40 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 41/24 - 2/24 as zeitstempel, value41 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 42/24 - 2/24 as zeitstempel, value42 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 43/24 - 2/24 as zeitstempel, value43 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 44/24 - 2/24 as zeitstempel, value44 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 45/24 - 2/24 as zeitstempel, value45 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 46/24 - 2/24 as zeitstempel, value46 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 47/24 - 2/24 as zeitstempel, value47 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 48/24 - 2/24 as zeitstempel, value48 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 49/24 - 2/24 as zeitstempel, value49 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 50/24 - 2/24 as zeitstempel, value50 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 51/24 - 2/24 as zeitstempel, value51 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 52/24 - 2/24 as zeitstempel, value52 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 53/24 - 2/24 as zeitstempel, value53 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 54/24 - 2/24 as zeitstempel, value54 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 55/24 - 2/24 as zeitstempel, value55 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 56/24 - 2/24 as zeitstempel, value56 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 57/24 - 2/24 as zeitstempel, value57 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 58/24 - 2/24 as zeitstempel, value58 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 59/24 - 2/24 as zeitstempel, value59 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 60/24 - 2/24 as zeitstempel, value60 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 61/24 - 2/24 as zeitstempel, value61 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 62/24 - 2/24 as zeitstempel, value62 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 63/24 - 2/24 as zeitstempel, value63 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 64/24 - 2/24 as zeitstempel, value64 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 65/24 - 2/24 as zeitstempel, value65 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 66/24 - 2/24 as zeitstempel, value66 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 67/24 - 2/24 as zeitstempel, value67 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 68/24 - 2/24 as zeitstempel, value68 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 69/24 - 2/24 as zeitstempel, value69 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 70/24 - 2/24 as zeitstempel, value70 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 71/24 - 2/24 as zeitstempel, value71 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 72/24 - 2/24 as zeitstempel, value72 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 73/24 - 2/24 as zeitstempel, value73 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 74/24 - 2/24 as zeitstempel, value74 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 75/24 - 2/24 as zeitstempel, value75 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 76/24 - 2/24 as zeitstempel, value76 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 77/24 - 2/24 as zeitstempel, value77 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 78/24 - 2/24 as zeitstempel, value78 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 79/24 - 2/24 as zeitstempel, value79 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 80/24 - 2/24 as zeitstempel, value80 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 81/24 - 2/24 as zeitstempel, value81 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 82/24 - 2/24 as zeitstempel, value82 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 83/24 - 2/24 as zeitstempel, value83 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 84/24 - 2/24 as zeitstempel, value84 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 85/24 - 2/24 as zeitstempel, value85 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 86/24 - 2/24 as zeitstempel, value86 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 87/24 - 2/24 as zeitstempel, value87 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 88/24 - 2/24 as zeitstempel, value88 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 89/24 - 2/24 as zeitstempel, value89 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 90/24 - 2/24 as zeitstempel, value90 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 91/24 - 2/24 as zeitstempel, value91 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 92/24 - 2/24 as zeitstempel, value92 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 93/24 - 2/24 as zeitstempel, value93 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 94/24 - 2/24 as zeitstempel, value94 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 95/24 - 2/24 as zeitstempel, value95 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 96/24 - 2/24 as zeitstempel, value96 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) ))
                where zeitstempel &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and 
                        zeitstempel &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;)&#34;&#34;&#34;

    # Database Connection &amp; Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 4:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 1h resolution.&#34;))

            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame([row[1] for row in ts_cursor], index=[row[0] for row in ts_cursor], columns=[&#39;value&#39;])
    if len(data_db) &gt; 0:
        data_db.index = data_db.index.tz_localize(&#39;Etc/GMT-1&#39;)

    # Reindexing &amp; Assignment of Return Variable
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(minutes=60), freq=&#39;1h&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;
    if len(data_db) &gt; 0:
        data_out[&#39;value&#39;] = data_db[&#39;value&#39;]
    if offset_summertime:
        data_out.index = data_out.index.tz_convert(&#39;CET&#39;)
    data_out[&#39;value&#39;] = pd.to_numeric(data_out[&#39;value&#39;])

    # Convert to pd.Series if only one column
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[&#39;value&#39;]

    return data_out


## 1d Time Series Retrieval
def get_timeseries_1d(ts_id:int, date_from, date_to,
                      mandant_user:str, mandant_pwd, mandant_addr:str,
                      col_name:str=&#39;value&#39;, str_table:str=&#39;meanvalues&#39;,
                      USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 1-day resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                              Start date is inclusive of `date_from` value, i.e., the start date will
                              be included in the extraction range. Format examples:
                              - datetime(2024, 1, 1, 0, 0, 0)
                              - datetime.strptime(date_string, format)
                              - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **str_table** (str): Table name suffix for ts_{str_table} to determine target table as specified by
                               SQL database structure. Defaults to &#39;meanvalues&#39;, other option is &#39;sumvalues&#39;.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
    &#34;&#34;&#34;

    # Convert datetime to string for SQL Input
    str_from = date_from.strftime(&#34;%d.%m.%Y&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_{str_table} tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_date(&#39;{str_from}&#39;, &#39;DD.MM.YYYY&#39;) and
                            tsd.tstamp_ts &lt; to_date(&#39;{str_to}&#39;, &#39;DD.MM.YYYY&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define Query String
    str_sql = f&#34;&#34;&#34;select tstamp_ts, value0_fl, state_l 
                  from tsd_{str_table}
                  where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id})
                    and tstamp_ts &gt;= to_date(&#39;{str_from}&#39;, &#39;DD.MM.YYYY&#39;)
                    and tstamp_ts &lt; to_date(&#39;{str_to}&#39;, &#39;DD.MM.YYYY&#39;)&#34;&#34;&#34;

    # Database Connection &amp; Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 1:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 1d resolution.&#34;))

            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(days=1), freq=&#39;1d&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;

    # Exception Handling based on state_l
    for i in range(len(ts_cursor)):
        if ts_cursor[i][2] != 285212672:
            data_out.loc[ts_cursor[i][0], col_name] = ts_cursor[i][1]

    # Timezone &amp; Data Type Conversion
    data_out.index = data_out.index.tz_localize(&#39;Etc/GMT-1&#39;)
    data_out[col_name] = pd.to_numeric(data_out[col_name]).copy()

    # Convert to Series
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[col_name]

    return data_out


# def get_ts_info(ts_id, mandant_user:str, mandant_pwd, mandant_addr:str):
#
#     # SQL Query String
#     str_sql = f&#34;&#34;&#34;
#         select vall.name_zr_s as ts_name,
#             vall.name_inst_s as ts_parent,
#             vall.ident_vl_l as ts_id,
#             vall.einheit_s as ts_unit,
#             vall.creation_ts as ts_creation,
#             vall.lastsave_ts as ts_lastsave
#         from v_zr_all vall
#         where vall.ident_vl_l = TO_NUMBER(:ts_int)
#     &#34;&#34;&#34;
#     print(str_sql)
#     with oracledb.connect(user=mandant_user, password=mandant_pwd,
#                           dsn=mandant_addr) as db_conn:
#         db_cursor = db_conn.cursor()
#
#         # Fetch data from db
#         ts_cursor = db_cursor.execute(str_sql, {&#39;ts_int&#39;: ts_id}).fetchall()
#
#     # Post-Query Data Handling
#     data_db = pd.DataFrame.from_records(ts_cursor, columns =[&#39;ts_name&#39;, &#39;ts_parent&#39;, &#39;ts_id&#39;, &#39;ts_unit&#39;,
#                                                              &#39;ts_creation&#39;, &#39;ts_lastsave&#39;])
#
#     return data_db


def ts_name_lookup(str_name:str, mandant_user:str, mandant_pwd, mandant_addr:str):
    &#34;&#34;&#34;
    Find time series from a string pattern search of all available time series in a Belvis mandant.

    Parameters:
        - **str_name** (str): String pattern for &#39;WHERE LIKE {}&#39; SQL clause. Example: &#39;%NM%Prognose&#39;
                              for time series &#39;Niederschlagsmenge.Prognose.Meteomatics&#39;
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr** (str): Address of the selected BelVis Mandant.

    Returns:
        - **pd.DataFrame**: Time series overview for ts names with matching patterns. Includes name,
                        ts ids, parent infos, creation and lastsave dates.
    &#34;&#34;&#34;
    # SQL Query String
    str_sql = f&#34;&#34;&#34;
        select vall.name_zr_s as ts_name,
            vall.name_inst_s as ts_parent,
            vall.ident_vl_l as ts_id, 
            vall.einheit_s as ts_unit,
            vall.creation_ts as ts_creation,
            vall.lastsave_ts as ts_lastsave
        from v_zr_all vall
        where vall.name_zr_s like :name_pattern
    &#34;&#34;&#34;

    with oracledb.connect(user=mandant_user, password=mandant_pwd,
                          dsn=mandant_addr) as db_conn:
        db_cursor = db_conn.cursor()

        # Fetch data from db
        ts_cursor = db_cursor.execute(str_sql, {&#39;name_pattern&#39;: str_name}).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame.from_records(ts_cursor, columns =[&#39;ts_name&#39;, &#39;ts_parent&#39;,&#39;ts_id&#39;, &#39;ts_unit&#39;, &#39;ts_creation&#39;, &#39;ts_lastsave&#39;])

    return data_db</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="solutil.dbqueries.get_env_variables"><code class="name flex">
<span>def <span class="ident">get_env_variables</span></span>(<span>mandant:Â str, scope:Â strÂ =Â 'get_ts')</span>
</code></dt>
<dd>
<div class="desc"><p>Retrieve setup variables from .env environment file, e.g., BelVis username &amp; password.</p>
<h2 id="parameters">Parameters</h2>
<ul>
<li><strong>mandant</strong> (str): Any existing Belvis Mandant. Commonly used: 'EPAG_PFM' or 'EPAG_ENERGIE'.</li>
<li><strong>scope</strong> (str): Scope of to-be-retrieved variables. Can be 'all' or 'get_ts'.</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li><strong>env_dict</strong> (dict): Dictionary with environment variables of the selected scope.</li>
</ul>
<h2 id="notes">Notes</h2>
<p>With 'get_ts', the resulting env_dict can directly be passed to the get_timeseries
function and unpacked with the ** operator.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_env_variables(mandant:str, scope:str=&#39;get_ts&#39;):
    &#34;&#34;&#34;
    Retrieve setup variables from .env environment file, e.g., BelVis username &amp; password.

    Parameters:
        - **mandant** (str): Any existing Belvis Mandant. Commonly used: &#39;EPAG_PFM&#39; or &#39;EPAG_ENERGIE&#39;.
        - **scope** (str): Scope of to-be-retrieved variables. Can be &#39;all&#39; or &#39;get_ts&#39;.

    Returns:
        - **env_dict** (dict): Dictionary with environment variables of the selected scope.

    Notes:
        With &#39;get_ts&#39;, the resulting env_dict can directly be passed to the get_timeseries
        function and unpacked with the ** operator.
    &#34;&#34;&#34;
    # Try to load environment file if it exists
    if not load_dotenv():
        raise FileNotFoundError(&#34;No .env file exists in the current directory.&#34;)

    match scope:
        case &#39;all&#39;:
            env_dict = {key:value for (key, value) in os.environ}
        case &#39;get_ts&#39;:
            # Get input variables for get_timeseries functions
            env_keys = [&#39;mandant_user&#39;, &#39;mandant_pwd&#39;, &#39;mandant_addr&#39;]
            mandant_user = os.getenv(f&#39;{mandant}_USER&#39;)
            mandant_pwd = os.getenv(f&#39;{mandant}_PWD&#39;)
            mandant_addr = os.getenv(&#39;BELVIS_ADDR_NEW&#39;)
            env_values = [mandant_user, mandant_pwd, mandant_addr]

            # Combine to dict
            env_dict = dict(zip(env_keys, env_values))
        case _:
            env_dict = None
            print(f&#39;Scope input {scope} does not match options: [all, get_ts]&#39;)

    return env_dict</code></pre>
</details>
</dd>
<dt id="solutil.dbqueries.get_timeseries_15min"><code class="name flex">
<span>def <span class="ident">get_timeseries_15min</span></span>(<span>ts_id:Â int, date_from, date_to, mandant_user:Â str, mandant_pwd, mandant_addr:Â str, offset_summertime:Â boolÂ =Â False, col_name:Â strÂ =Â 'value', USE_OLD_CX_ORACLE:Â boolÂ =Â False)</span>
</code></dt>
<dd>
<div class="desc"><p>Extract 15-minute resolution time series from various BelVis database Mandanten.</p>
<h2 id="parameters">Parameters</h2>
<ul>
<li><strong>ts_id</strong> (int): The BelVis time series ID in integer format, e.g., 404212442.</li>
<li><strong>date_from</strong> (dt): A datetime object representing the start date of the export window.
Start date is inclusive of <code>date_from</code> value, i.e., the start date will
be included in the extraction range. Format examples:
- datetime(2024, 1, 1, 0, 0, 0)
- datetime.strptime(date_string, format)
- any other datetime object</li>
<li><strong>date_to</strong> (dt): A datetime object representing the end date of the export window.
The end date is not included in the queried output.</li>
<li><strong>mandant_user</strong> (str): Username for the BelVis Mandant.</li>
<li><strong>mandant_pwd</strong> (str): Password for the selected BelVis Mandant.</li>
<li>**mandant_addr"" (str): Address of the selected BelVis Mandant.</li>
<li><strong>offset_summertime</strong> (bool): Indicator whether summertime is offset, i.e., whether
timestamps are in Etc/GMT-1 or local time. If False, code will
directly localize timestamp at Etc/GMT-1, else it will
first convert to CET before Etc/GMT-1.</li>
<li><strong>col_name</strong> (str): Column name which the output dataframe column should bear.</li>
<li><strong>USE_OLD_CX_ORACLE</strong> (bool): Switch variable to use old database connection module. Deprecated under
Python versions &gt;3.6.</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li><strong>data_out</strong> (pd.Series): Dataframe with output time series; timestamp index and <code>col_name</code> name.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_timeseries_15min(ts_id: int, date_from, date_to,
                         mandant_user:str, mandant_pwd, mandant_addr:str,
                         offset_summertime: bool = False, col_name: str = &#39;value&#39;,
                         USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 15-minute resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                          Start date is inclusive of `date_from` value, i.e., the start date will
                          be included in the extraction range. Format examples:
                          - datetime(2024, 1, 1, 0, 0, 0)
                          - datetime.strptime(date_string, format)
                          - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **offset_summertime** (bool): Indicator whether summertime is offset, i.e., whether
                                        timestamps are in Etc/GMT-1 or local time. If False, code will
                                        directly localize timestamp at Etc/GMT-1, else it will
                                        first convert to CET before Etc/GMT-1.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **USE_OLD_CX_ORACLE** (bool): Switch variable to use old database connection module. Deprecated under
                                        Python versions &gt;3.6.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
&#34;&#34;&#34;
    if date_from.tzinfo is None:
        # Convert start and end dates if summertime offset is desired
        if offset_summertime:
            date_from = timezone(&#39;CET&#39;).localize(date_from)
            date_to = timezone(&#39;CET&#39;).localize(date_to)
            date_from = date_from.astimezone(timezone(&#39;Etc/GMT-1&#39;))
            date_to = date_to.astimezone(timezone(&#39;Etc/GMT-1&#39;)) # Etc/GMT-1 actually refers to GMT+1, as highlighted
            # in https://stackoverflow.com/questions/53076575/time-zones-etc-gmt-why-it-is-other-way-round
        else:
            # Localize timestamps to constant Etc/GMT-1
            date_from = timezone(&#39;Etc/GMT-1&#39;).localize(date_from)
            date_to = timezone(&#39;Etc/GMT-1&#39;).localize(date_to)

    # Convert back to str format for SQL Query
    str_from = date_from.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_wnmin195 tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            tsd.tstamp_ts &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define query string
    str_sql = f&#34;&#34;&#34;select zeitstempel, value from
                    (select
                        case when zeitstempel is not null
                                and zeitstempel &gt;= next_day( to_date(concat( extract(year from zeitstempel),
                                                                                &#39;0401.02&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                and zeitstempel &lt; next_day( to_date(concat( extract(year from zeitstempel),
                                                                                &#39;1101.03&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                then
                            zeitstempel + 0/24
                        else zeitstempel  end as zeitstempel, value, timeseries_l
                        from
                    (
                    select timeseries_l, tstamp_ts + 1/96 - 2/96 as zeitstempel, value1 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 2/96 - 2/96 as zeitstempel, value2 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 3/96 - 2/96 as zeitstempel, value3 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 4/96 - 2/96 as zeitstempel, value4 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 5/96 - 2/96 as zeitstempel, value5 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 6/96 - 2/96 as zeitstempel, value6 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 7/96 - 2/96 as zeitstempel, value7 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 8/96 - 2/96 as zeitstempel, value8 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 9/96 - 2/96 as zeitstempel, value9 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 10/96 - 2/96 as zeitstempel, value10 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 11/96 - 2/96 as zeitstempel, value11 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 12/96 - 2/96 as zeitstempel, value12 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 13/96 - 2/96 as zeitstempel, value13 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 14/96 - 2/96 as zeitstempel, value14 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 15/96 - 2/96 as zeitstempel, value15 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 16/96 - 2/96 as zeitstempel, value16 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 17/96 - 2/96 as zeitstempel, value17 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 18/96 - 2/96 as zeitstempel, value18 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 19/96 - 2/96 as zeitstempel, value19 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 20/96 - 2/96 as zeitstempel, value20 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 21/96 - 2/96 as zeitstempel, value21 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 22/96 - 2/96 as zeitstempel, value22 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 23/96 - 2/96 as zeitstempel, value23 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 24/96 - 2/96 as zeitstempel, value24 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 25/96 - 2/96 as zeitstempel, value25 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 26/96 - 2/96 as zeitstempel, value26 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 27/96 - 2/96 as zeitstempel, value27 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 28/96 - 2/96 as zeitstempel, value28 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 29/96 - 2/96 as zeitstempel, value29 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 30/96 - 2/96 as zeitstempel, value30 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 31/96 - 2/96 as zeitstempel, value31 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 32/96 - 2/96 as zeitstempel, value32 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 33/96 - 2/96 as zeitstempel, value33 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 34/96 - 2/96 as zeitstempel, value34 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 35/96 - 2/96 as zeitstempel, value35 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 36/96 - 2/96 as zeitstempel, value36 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 37/96 - 2/96 as zeitstempel, value37 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 38/96 - 2/96 as zeitstempel, value38 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 39/96 - 2/96 as zeitstempel, value39 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 40/96 - 2/96 as zeitstempel, value40 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 41/96 - 2/96 as zeitstempel, value41 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 42/96 - 2/96 as zeitstempel, value42 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 43/96 - 2/96 as zeitstempel, value43 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 44/96 - 2/96 as zeitstempel, value44 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 45/96 - 2/96 as zeitstempel, value45 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 46/96 - 2/96 as zeitstempel, value46 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 47/96 - 2/96 as zeitstempel, value47 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 48/96 - 2/96 as zeitstempel, value48 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 49/96 - 2/96 as zeitstempel, value49 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 50/96 - 2/96 as zeitstempel, value50 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 51/96 - 2/96 as zeitstempel, value51 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 52/96 - 2/96 as zeitstempel, value52 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 53/96 - 2/96 as zeitstempel, value53 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 54/96 - 2/96 as zeitstempel, value54 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 55/96 - 2/96 as zeitstempel, value55 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 56/96 - 2/96 as zeitstempel, value56 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 57/96 - 2/96 as zeitstempel, value57 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 58/96 - 2/96 as zeitstempel, value58 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 59/96 - 2/96 as zeitstempel, value59 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 60/96 - 2/96 as zeitstempel, value60 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 61/96 - 2/96 as zeitstempel, value61 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 62/96 - 2/96 as zeitstempel, value62 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 63/96 - 2/96 as zeitstempel, value63 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 64/96 - 2/96 as zeitstempel, value64 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 65/96 - 2/96 as zeitstempel, value65 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 66/96 - 2/96 as zeitstempel, value66 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 67/96 - 2/96 as zeitstempel, value67 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 68/96 - 2/96 as zeitstempel, value68 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 69/96 - 2/96 as zeitstempel, value69 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 70/96 - 2/96 as zeitstempel, value70 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 71/96 - 2/96 as zeitstempel, value71 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 72/96 - 2/96 as zeitstempel, value72 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 73/96 - 2/96 as zeitstempel, value73 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 74/96 - 2/96 as zeitstempel, value74 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 75/96 - 2/96 as zeitstempel, value75 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 76/96 - 2/96 as zeitstempel, value76 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 77/96 - 2/96 as zeitstempel, value77 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 78/96 - 2/96 as zeitstempel, value78 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 79/96 - 2/96 as zeitstempel, value79 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 80/96 - 2/96 as zeitstempel, value80 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 81/96 - 2/96 as zeitstempel, value81 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 82/96 - 2/96 as zeitstempel, value82 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 83/96 - 2/96 as zeitstempel, value83 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 84/96 - 2/96 as zeitstempel, value84 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 85/96 - 2/96 as zeitstempel, value85 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 86/96 - 2/96 as zeitstempel, value86 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 87/96 - 2/96 as zeitstempel, value87 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 88/96 - 2/96 as zeitstempel, value88 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 89/96 - 2/96 as zeitstempel, value89 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 90/96 - 2/96 as zeitstempel, value90 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 91/96 - 2/96 as zeitstempel, value91 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 92/96 - 2/96 as zeitstempel, value92 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 93/96 - 2/96 as zeitstempel, value93 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 94/96 - 2/96 as zeitstempel, value94 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 95/96 - 2/96 as zeitstempel, value95 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 96/96 - 2/96 as zeitstempel, value96 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) ))
                where zeitstempel &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                        zeitstempel &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;)&#34;&#34;&#34;
    # logging.info(&#34;before db data fetching&#34;)

    # DB Connection and Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 1:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 15min resolution.&#34;))

            # Fetch data from db
            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame([row[1] for row in ts_cursor], index=[row[0] for row in ts_cursor], columns=[&#39;value&#39;])
    if len(data_db) &gt; 0:
        data_db.index = data_db.index.tz_localize(&#39;Etc/GMT-1&#39;)

    # Reindexing &amp; Assignment of Return Variable
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(minutes=15), freq=&#39;15min&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;
    if len(data_db) &gt; 0:
        data_out[&#39;value&#39;] = data_db[&#39;value&#39;]
    if offset_summertime:
        data_out.index = data_out.index.tz_convert(&#39;CET&#39;)
    data_out[&#39;value&#39;] = pd.to_numeric(data_out[&#39;value&#39;])

    # Convert to pd.Series if only one column
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[&#39;value&#39;]

    return data_out</code></pre>
</details>
</dd>
<dt id="solutil.dbqueries.get_timeseries_1d"><code class="name flex">
<span>def <span class="ident">get_timeseries_1d</span></span>(<span>ts_id:Â int, date_from, date_to, mandant_user:Â str, mandant_pwd, mandant_addr:Â str, col_name:Â strÂ =Â 'value', str_table:Â strÂ =Â 'meanvalues', USE_OLD_CX_ORACLE:Â boolÂ =Â False)</span>
</code></dt>
<dd>
<div class="desc"><p>Extract 1-day resolution time series from various BelVis database Mandanten.</p>
<h2 id="parameters">Parameters</h2>
<ul>
<li><strong>ts_id</strong> (int): The BelVis time series ID in integer format, e.g., 404212442.</li>
<li><strong>date_from</strong> (dt): A datetime object representing the start date of the export window.
Start date is inclusive of <code>date_from</code> value, i.e., the start date will
be included in the extraction range. Format examples:
- datetime(2024, 1, 1, 0, 0, 0)
- datetime.strptime(date_string, format)
- any other datetime object</li>
<li><strong>date_to</strong> (dt): A datetime object representing the end date of the export window.
The end date is not included in the queried output.</li>
<li><strong>mandant_user</strong> (str): Username for the BelVis Mandant.</li>
<li><strong>mandant_pwd</strong> (str): Password for the selected BelVis Mandant.</li>
<li>**mandant_addr"" (str): Address of the selected BelVis Mandant.</li>
<li><strong>col_name</strong> (str): Column name which the output dataframe column should bear.</li>
<li><strong>str_table</strong> (str): Table name suffix for ts_{str_table} to determine target table as specified by
SQL database structure. Defaults to 'meanvalues', other option is 'sumvalues'.</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li><strong>data_out</strong> (pd.Series): Dataframe with output time series; timestamp index and <code>col_name</code> name.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_timeseries_1d(ts_id:int, date_from, date_to,
                      mandant_user:str, mandant_pwd, mandant_addr:str,
                      col_name:str=&#39;value&#39;, str_table:str=&#39;meanvalues&#39;,
                      USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 1-day resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                              Start date is inclusive of `date_from` value, i.e., the start date will
                              be included in the extraction range. Format examples:
                              - datetime(2024, 1, 1, 0, 0, 0)
                              - datetime.strptime(date_string, format)
                              - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **str_table** (str): Table name suffix for ts_{str_table} to determine target table as specified by
                               SQL database structure. Defaults to &#39;meanvalues&#39;, other option is &#39;sumvalues&#39;.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
    &#34;&#34;&#34;

    # Convert datetime to string for SQL Input
    str_from = date_from.strftime(&#34;%d.%m.%Y&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_{str_table} tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_date(&#39;{str_from}&#39;, &#39;DD.MM.YYYY&#39;) and
                            tsd.tstamp_ts &lt; to_date(&#39;{str_to}&#39;, &#39;DD.MM.YYYY&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define Query String
    str_sql = f&#34;&#34;&#34;select tstamp_ts, value0_fl, state_l 
                  from tsd_{str_table}
                  where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id})
                    and tstamp_ts &gt;= to_date(&#39;{str_from}&#39;, &#39;DD.MM.YYYY&#39;)
                    and tstamp_ts &lt; to_date(&#39;{str_to}&#39;, &#39;DD.MM.YYYY&#39;)&#34;&#34;&#34;

    # Database Connection &amp; Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 1:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 1d resolution.&#34;))

            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(days=1), freq=&#39;1d&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;

    # Exception Handling based on state_l
    for i in range(len(ts_cursor)):
        if ts_cursor[i][2] != 285212672:
            data_out.loc[ts_cursor[i][0], col_name] = ts_cursor[i][1]

    # Timezone &amp; Data Type Conversion
    data_out.index = data_out.index.tz_localize(&#39;Etc/GMT-1&#39;)
    data_out[col_name] = pd.to_numeric(data_out[col_name]).copy()

    # Convert to Series
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[col_name]

    return data_out</code></pre>
</details>
</dd>
<dt id="solutil.dbqueries.get_timeseries_1h"><code class="name flex">
<span>def <span class="ident">get_timeseries_1h</span></span>(<span>ts_id:Â int, date_from, date_to, mandant_user:Â str, mandant_pwd, mandant_addr:Â str, offset_summertime:Â boolÂ =Â False, col_name:Â strÂ =Â 'value', USE_OLD_CX_ORACLE:Â boolÂ =Â False)</span>
</code></dt>
<dd>
<div class="desc"><p>Extract 1-hour resolution time series from various BelVis database Mandanten.</p>
<h2 id="parameters">Parameters</h2>
<ul>
<li><strong>ts_id</strong> (int): The BelVis time series ID in integer format, e.g., 404212442.</li>
<li><strong>date_from</strong> (dt): A datetime object representing the start date of the export window.
Start date is inclusive of <code>date_from</code> value, i.e., the start date will
be included in the extraction range. Format examples:
- datetime(2024, 1, 1, 0, 0, 0)
- datetime.strptime(date_string, format)
- any other datetime object</li>
<li><strong>date_to</strong> (dt): A datetime object representing the end date of the export window.
The end date is not included in the queried output.</li>
<li><strong>mandant_user</strong> (str): Username for the BelVis Mandant.</li>
<li><strong>mandant_pwd</strong> (str): Password for the selected BelVis Mandant.</li>
<li>**mandant_addr"" (str): Address of the selected BelVis Mandant.</li>
<li><strong>offset_summertime</strong> (bool): Indicator whether summertime is offset, i.e., whether
timestamps are in CET or local time. If False, code will
directly localize timestamp at Etc/GMT-1, else it will
first convert to CET before Etc/GMT-1.</li>
<li><strong>col_name</strong> (str): Column name which the output dataframe column should bear.</li>
<li><strong>USE_OLD_CX_ORACLE</strong> (bool): Switch variable to use old database connection module. Deprecated under
Python versions &gt;3.6.</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li><strong>data_out</strong> (pd.Series): Dataframe with output time series; timestamp index and <code>col_name</code> name.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_timeseries_1h(ts_id: int, date_from, date_to,
                         mandant_user:str, mandant_pwd, mandant_addr:str,
                         offset_summertime: bool = False, col_name: str = &#39;value&#39;,
                         USE_OLD_CX_ORACLE:bool=False):
    &#34;&#34;&#34;
    Extract 1-hour resolution time series from various BelVis database Mandanten.

    Parameters:
        - **ts_id** (int): The BelVis time series ID in integer format, e.g., 404212442.
        - **date_from** (dt): A datetime object representing the start date of the export window.
                              Start date is inclusive of `date_from` value, i.e., the start date will
                              be included in the extraction range. Format examples:
                              - datetime(2024, 1, 1, 0, 0, 0)
                              - datetime.strptime(date_string, format)
                              - any other datetime object
        - **date_to** (dt): A datetime object representing the end date of the export window.
                            The end date is not included in the queried output.
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr&#34;&#34; (str): Address of the selected BelVis Mandant.
        - **offset_summertime** (bool): Indicator whether summertime is offset, i.e., whether
                                        timestamps are in CET or local time. If False, code will
                                        directly localize timestamp at Etc/GMT-1, else it will
                                        first convert to CET before Etc/GMT-1.
        - **col_name** (str): Column name which the output dataframe column should bear.
        - **USE_OLD_CX_ORACLE** (bool): Switch variable to use old database connection module. Deprecated under
                                        Python versions &gt;3.6.

    Returns:
        - **data_out** (pd.Series): Dataframe with output time series; timestamp index and `col_name` name.
    &#34;&#34;&#34;

    if date_from.tzinfo is None:
        if offset_summertime:
            date_from = timezone(&#39;CET&#39;).localize(date_from)
            date_to = timezone(&#39;CET&#39;).localize(date_to)
            date_from = date_from.astimezone(timezone(&#39;Etc/GMT-1&#39;))
            date_to = date_to.astimezone(timezone(&#39;Etc/GMT-1&#39;))
        else:
            date_from = timezone(&#39;Etc/GMT-1&#39;).localize(date_from)
            date_to = timezone(&#39;Etc/GMT-1&#39;).localize(date_to)

    # Convert back to str format for SQL Query
    str_from = date_from.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)
    str_to = date_to.strftime(&#34;%d.%m.%Y %H:%M:%S&#34;)

    # Define timedelta check query string
    check_str_sql = f&#34;&#34;&#34;select tsd.tstamp_ts,
                            tsd.tstamp_ts - lag(tsd.tstamp_ts) over (order by tsd.tstamp_ts) as date_diff
                        from tsd_wnmin195 tsd
                        where tsd.timeseries_l = (
                            select min(ident)
                            from ts_timeseries ts
                            where ts.valuelist_l = {ts_id}
                            ) and
                            tsd.tstamp_ts &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            tsd.tstamp_ts &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and
                            ROWNUM &lt;= 2
                    &#34;&#34;&#34;

    # Define query string
    str_sql = f&#34;&#34;&#34;select zeitstempel, value from 
                    (select
                        case when zeitstempel is not null 
                                and zeitstempel &gt;= next_day( to_date(concat( extract(year from zeitstempel), 
                                                                                &#39;0401.02&#39;), &#39;yyyymmdd.HH&#39;) -8,7)  
                                and zeitstempel &lt; next_day( to_date(concat( extract(year from zeitstempel), 
                                                                                &#39;1101.03&#39;), &#39;yyyymmdd.HH&#39;) -8,7)
                                then 
                            zeitstempel + 0/24
                        else zeitstempel  end as zeitstempel, value, timeseries_l
                        from
                    (
                    select timeseries_l, tstamp_ts + 1/24 - 2/24 as zeitstempel, value1 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 2/24 - 2/24 as zeitstempel, value2 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 3/24 - 2/24 as zeitstempel, value3 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 4/24 - 2/24 as zeitstempel, value4 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 5/24 - 2/24 as zeitstempel, value5 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 6/24 - 2/24 as zeitstempel, value6 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 7/24 - 2/24 as zeitstempel, value7 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 8/24 - 2/24 as zeitstempel, value8 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 9/24 - 2/24 as zeitstempel, value9 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 10/24 - 2/24 as zeitstempel, value10 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 11/24 - 2/24 as zeitstempel, value11 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 12/24 - 2/24 as zeitstempel, value12 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 13/24 - 2/24 as zeitstempel, value13 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 14/24 - 2/24 as zeitstempel, value14 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 15/24 - 2/24 as zeitstempel, value15 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 16/24 - 2/24 as zeitstempel, value16 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 17/24 - 2/24 as zeitstempel, value17 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 18/24 - 2/24 as zeitstempel, value18 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 19/24 - 2/24 as zeitstempel, value19 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 20/24 - 2/24 as zeitstempel, value20 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 21/24 - 2/24 as zeitstempel, value21 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 22/24 - 2/24 as zeitstempel, value22 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 23/24 - 2/24 as zeitstempel, value23 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 24/24 - 2/24 as zeitstempel, value24 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 25/24 - 2/24 as zeitstempel, value25 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 26/24 - 2/24 as zeitstempel, value26 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 27/24 - 2/24 as zeitstempel, value27 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 28/24 - 2/24 as zeitstempel, value28 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 29/24 - 2/24 as zeitstempel, value29 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 30/24 - 2/24 as zeitstempel, value30 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 31/24 - 2/24 as zeitstempel, value31 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 32/24 - 2/24 as zeitstempel, value32 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 33/24 - 2/24 as zeitstempel, value33 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 34/24 - 2/24 as zeitstempel, value34 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 35/24 - 2/24 as zeitstempel, value35 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 36/24 - 2/24 as zeitstempel, value36 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 37/24 - 2/24 as zeitstempel, value37 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 38/24 - 2/24 as zeitstempel, value38 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 39/24 - 2/24 as zeitstempel, value39 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 40/24 - 2/24 as zeitstempel, value40 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 41/24 - 2/24 as zeitstempel, value41 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 42/24 - 2/24 as zeitstempel, value42 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 43/24 - 2/24 as zeitstempel, value43 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 44/24 - 2/24 as zeitstempel, value44 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 45/24 - 2/24 as zeitstempel, value45 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 46/24 - 2/24 as zeitstempel, value46 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 47/24 - 2/24 as zeitstempel, value47 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 48/24 - 2/24 as zeitstempel, value48 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 49/24 - 2/24 as zeitstempel, value49 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 50/24 - 2/24 as zeitstempel, value50 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 51/24 - 2/24 as zeitstempel, value51 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 52/24 - 2/24 as zeitstempel, value52 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 53/24 - 2/24 as zeitstempel, value53 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 54/24 - 2/24 as zeitstempel, value54 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 55/24 - 2/24 as zeitstempel, value55 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 56/24 - 2/24 as zeitstempel, value56 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 57/24 - 2/24 as zeitstempel, value57 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 58/24 - 2/24 as zeitstempel, value58 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 59/24 - 2/24 as zeitstempel, value59 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 60/24 - 2/24 as zeitstempel, value60 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 61/24 - 2/24 as zeitstempel, value61 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 62/24 - 2/24 as zeitstempel, value62 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 63/24 - 2/24 as zeitstempel, value63 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 64/24 - 2/24 as zeitstempel, value64 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 65/24 - 2/24 as zeitstempel, value65 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 66/24 - 2/24 as zeitstempel, value66 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 67/24 - 2/24 as zeitstempel, value67 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 68/24 - 2/24 as zeitstempel, value68 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 69/24 - 2/24 as zeitstempel, value69 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 70/24 - 2/24 as zeitstempel, value70 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 71/24 - 2/24 as zeitstempel, value71 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 72/24 - 2/24 as zeitstempel, value72 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 73/24 - 2/24 as zeitstempel, value73 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 74/24 - 2/24 as zeitstempel, value74 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 75/24 - 2/24 as zeitstempel, value75 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 76/24 - 2/24 as zeitstempel, value76 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 77/24 - 2/24 as zeitstempel, value77 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 78/24 - 2/24 as zeitstempel, value78 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 79/24 - 2/24 as zeitstempel, value79 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 80/24 - 2/24 as zeitstempel, value80 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 81/24 - 2/24 as zeitstempel, value81 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 82/24 - 2/24 as zeitstempel, value82 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 83/24 - 2/24 as zeitstempel, value83 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 84/24 - 2/24 as zeitstempel, value84 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 85/24 - 2/24 as zeitstempel, value85 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 86/24 - 2/24 as zeitstempel, value86 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 87/24 - 2/24 as zeitstempel, value87 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 88/24 - 2/24 as zeitstempel, value88 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 89/24 - 2/24 as zeitstempel, value89 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 90/24 - 2/24 as zeitstempel, value90 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 91/24 - 2/24 as zeitstempel, value91 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 92/24 - 2/24 as zeitstempel, value92 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 93/24 - 2/24 as zeitstempel, value93 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 94/24 - 2/24 as zeitstempel, value94 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 95/24 - 2/24 as zeitstempel, value95 as value from tsd_wnmin195 
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) union
                    select timeseries_l, tstamp_ts + 96/24 - 2/24 as zeitstempel, value96 as value from tsd_wnmin195
                    where timeseries_l = (select min(ident) from ts_timeseries where valuelist_l = {ts_id}) ))
                where zeitstempel &gt;= to_timestamp(&#39;{str_from}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;) and 
                        zeitstempel &lt; to_timestamp(&#39;{str_to}&#39;, &#39;DD.MM.YYYY HH24:MI:SS&#39;)&#34;&#34;&#34;

    # Database Connection &amp; Data Retrieval
    if USE_OLD_CX_ORACLE:
        with cx_Oracle.connect(mandant_user, mandant_pwd, mandant_addr) as db_conn: # xc_Oracle only seems to run with Python versions 3.6 thru 3.10
            db_cursor = db_conn.cursor()
            ts_cursor = db_cursor.execute(str_sql).fetchall()
    else:
        # New db connection module
        with oracledb.connect(user=mandant_user, password=mandant_pwd,
                              dsn=mandant_addr) as db_conn:
            db_cursor = db_conn.cursor()

            # Check timedelta conformity with get_timeseries interval
            ts_check = db_cursor.execute(check_str_sql).fetchall()
            df_check = pd.DataFrame([row[1] for row in ts_check], index=[row[0] for row in ts_check], columns=[&#39;value&#39;])
            if len(df_check) &gt; 1:
                if df_check.iloc[1, 0] != 4:
                    print(warnings.warn(f&#34;Warning: Time series with ID {ts_id} might not be in 1h resolution.&#34;))

            ts_cursor = db_cursor.execute(str_sql).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame([row[1] for row in ts_cursor], index=[row[0] for row in ts_cursor], columns=[&#39;value&#39;])
    if len(data_db) &gt; 0:
        data_db.index = data_db.index.tz_localize(&#39;Etc/GMT-1&#39;)

    # Reindexing &amp; Assignment of Return Variable
    index_ts = pd.date_range(start=date_from, end=date_to - timedelta(minutes=60), freq=&#39;1h&#39;)
    data_out = pd.DataFrame(index=index_ts, columns=[col_name])
    data_out.index.name = &#39;Timestamp&#39;
    if len(data_db) &gt; 0:
        data_out[&#39;value&#39;] = data_db[&#39;value&#39;]
    if offset_summertime:
        data_out.index = data_out.index.tz_convert(&#39;CET&#39;)
    data_out[&#39;value&#39;] = pd.to_numeric(data_out[&#39;value&#39;])

    # Convert to pd.Series if only one column
    if len(data_out.columns) &lt;= 1:
        data_out = data_out[&#39;value&#39;]

    return data_out</code></pre>
</details>
</dd>
<dt id="solutil.dbqueries.ts_name_lookup"><code class="name flex">
<span>def <span class="ident">ts_name_lookup</span></span>(<span>str_name:Â str, mandant_user:Â str, mandant_pwd, mandant_addr:Â str)</span>
</code></dt>
<dd>
<div class="desc"><p>Find time series from a string pattern search of all available time series in a Belvis mandant.</p>
<h2 id="parameters">Parameters</h2>
<ul>
<li><strong>str_name</strong> (str): String pattern for 'WHERE LIKE {}' SQL clause. Example: '%NM%Prognose'
for time series 'Niederschlagsmenge.Prognose.Meteomatics'</li>
<li><strong>mandant_user</strong> (str): Username for the BelVis Mandant.</li>
<li><strong>mandant_pwd</strong> (str): Password for the selected BelVis Mandant.</li>
<li><strong>mandant_addr</strong> (str): Address of the selected BelVis Mandant.</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li><strong>pd.DataFrame</strong>: Time series overview for ts names with matching patterns. Includes name,
ts ids, parent infos, creation and lastsave dates.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def ts_name_lookup(str_name:str, mandant_user:str, mandant_pwd, mandant_addr:str):
    &#34;&#34;&#34;
    Find time series from a string pattern search of all available time series in a Belvis mandant.

    Parameters:
        - **str_name** (str): String pattern for &#39;WHERE LIKE {}&#39; SQL clause. Example: &#39;%NM%Prognose&#39;
                              for time series &#39;Niederschlagsmenge.Prognose.Meteomatics&#39;
        - **mandant_user** (str): Username for the BelVis Mandant.
        - **mandant_pwd** (str): Password for the selected BelVis Mandant.
        - **mandant_addr** (str): Address of the selected BelVis Mandant.

    Returns:
        - **pd.DataFrame**: Time series overview for ts names with matching patterns. Includes name,
                        ts ids, parent infos, creation and lastsave dates.
    &#34;&#34;&#34;
    # SQL Query String
    str_sql = f&#34;&#34;&#34;
        select vall.name_zr_s as ts_name,
            vall.name_inst_s as ts_parent,
            vall.ident_vl_l as ts_id, 
            vall.einheit_s as ts_unit,
            vall.creation_ts as ts_creation,
            vall.lastsave_ts as ts_lastsave
        from v_zr_all vall
        where vall.name_zr_s like :name_pattern
    &#34;&#34;&#34;

    with oracledb.connect(user=mandant_user, password=mandant_pwd,
                          dsn=mandant_addr) as db_conn:
        db_cursor = db_conn.cursor()

        # Fetch data from db
        ts_cursor = db_cursor.execute(str_sql, {&#39;name_pattern&#39;: str_name}).fetchall()

    # Post-Query Data Handling
    data_db = pd.DataFrame.from_records(ts_cursor, columns =[&#39;ts_name&#39;, &#39;ts_parent&#39;,&#39;ts_id&#39;, &#39;ts_unit&#39;, &#39;ts_creation&#39;, &#39;ts_lastsave&#39;])

    return data_db</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="solutil" href="index.html">solutil</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="solutil.dbqueries.get_env_variables" href="#solutil.dbqueries.get_env_variables">get_env_variables</a></code></li>
<li><code><a title="solutil.dbqueries.get_timeseries_15min" href="#solutil.dbqueries.get_timeseries_15min">get_timeseries_15min</a></code></li>
<li><code><a title="solutil.dbqueries.get_timeseries_1d" href="#solutil.dbqueries.get_timeseries_1d">get_timeseries_1d</a></code></li>
<li><code><a title="solutil.dbqueries.get_timeseries_1h" href="#solutil.dbqueries.get_timeseries_1h">get_timeseries_1h</a></code></li>
<li><code><a title="solutil.dbqueries.ts_name_lookup" href="#solutil.dbqueries.ts_name_lookup">ts_name_lookup</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>